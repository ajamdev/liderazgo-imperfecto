---
import { getCollection, render } from "astro:content";
import Layout from '@/layout/Base.astro'
import { Image } from "astro:assets";
import LinkedIn from "@/assets/social/linkedin.svg"
import YouTube from "@/assets/social/youtube.svg"

export async function getStaticPaths(){
  const profile = await getCollection('profile');

  return profile.map((profile: any) => ({
    params: { id: profile.slug },
    props: { profile },
  }));
}

const {profile} = Astro.props
const {data, slug} = profile
const {title, image, job, link} = data
const {Content} = await render(profile);
---
<Layout title={`Perfil de ${title}`} description={`Conoce mÃ¡s sobre ${title}, su experiencia y trayectoria profesional.`}>
  <main class=" w-full container mx-auto p-4 md:px-20 xl:px-40 xl:py-8 overflow-hidden">
    <div class="grid grid-cols-1 md:grid-cols-[320px_1fr] pt-12 gap-5">
      <aside class="profile-sidebar">
        <section class="space-y-6">
          <figure class="overflow-hidden w-full h-100 aspect-9/16 rounded-xl">
            <Image src={image} alt={title} width={512} height={180} class="w-full h-full object-cover" transition:name={`img-${slug}`}/>
          </figure>
          <header class="space-y-1.5">
            <h2 class="text-[clamp(var(--text-xl),5vw,var(--text-2xl))] font-bold italic">{title}</h2>
            {
              job.map((item: string, index: number)=>(
              <small class=" font-semibold text-text/50">
                {item}
                {index < job.length - 1 && ' | '}
              </small>
              ))
            }
          </header>
          <footer class="space-y-5">
            <nav aria-label="Redes sociales" class="flex gap-5 items-center">
              {link.linkedin && (
              <a href={link.linkedin} target="_blank" rel="noopener noreferrer" aria-label={`LinkedIn de ${title}`}>
                <LinkedIn />
              </a>
              )}
              {link.youtube && (
              <a href={link.youtube} target="_blank" rel="noopener noreferrer" aria-label={`YouTube de ${title}`}>
                <YouTube />
              </a>
              )}
            </nav>
          </footer>
        </section>
      </aside>
      <article class="profile-content">
        <header>
          <h1 class="font-bold text-[clamp(var(--text-3xl),5vw,var(--text-4xl))] italic mb-6">Sobre {title}</h1>
        </header>
        <div class="prose max-w-full max-h-full"><Content/></div>
      </article>
    </div>
  </main>
</Layout>